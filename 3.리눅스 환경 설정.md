# **3.리눅스 환경 설정**

- **모바텀(mobaxterm)에 접속해본다.**

세션 - SSH에서 private ip를 이용해 호스트에서 접속한다.

- **리눅스 설치 정보를 확인한다.**

```
[root@19crac1 ~]# uname -a
[root@19crac1 ~]# cat /etc/os-release
```

![Cap 2024-04-05 10-48-48-355](https://github.com/oraclejyp/19c_rac_inst/assets/133745372/679536ac-c814-4127-b537-889e9b34f1b3)

- **불필요한 서비스 정리**

```
### 방화벽 중지
systemctl stop firewalld
systemctl disable firewalld

### 블루투스 중지
systemctl stop bluetooth
systemctl disable bluetooth

### 시간 동기화 중지
systemctl stop chronyd
systemctl disable chronyd
mv /etc/chrony.conf /etc/chrony.conf.bak

### NTP 중지
systemctl stop ntpdate
systemctl disable ntpdate

### AVAHI 중지
systemctl stop avahi-daemon.socket
systemctl disable avahi-daemon.socket
systemctl stop avahi-daemon
systemctl disable avahi-daemon

### 가상 시스템 관리 중지
systemctl stop libvirtd
systemctl disable libvirtd
```

- **SELINUX 비활성화 하기**

```
[root@19crac1 ~]# vi /etc/selinux/config
```

SELINUX=disabled로 변경한다.


- **hosts 파일 수정**
```
[root@19crac1 ~]# vi /etc/hosts

### Public
10.0.2.15  rac1
10.0.2.16  rac2        
### Private
192.168.56.101  rac1-priv 
192.168.56.102  rac2-priv
### Virtual
10.0.2.111  rac1-vip 
10.0.2.112  rac2-vip 
### SCAN
10.0.2.120  rac-scan    
10.0.2.121  rac-scan    
10.0.2.122  rac-scan    
```

- **dnsmasq 활성화하기**

```
[root@19crac1 ~]# vi /etc/dnsmasq.conf
```

local=/localdomain/ 로 변경한다.

![image](https://github.com/oraclejyp/19c_rac_inst/assets/133745372/69ecbd74-979d-4432-92cc-b9fd39c33950)

```
[root@19crac1 ~]# systemctl start dnsmasq
[root@19crac1 ~]# systemctl enable dnsmasq

[root@19crac1 ~]# nslookup rac-scan
```

nslookup 명령어 수행을 위해 재부팅이 필요하면 수행한다.

![image](https://github.com/oraclejyp/19c_rac_inst/assets/133745372/5716153f-6012-4c39-8617-a7c84fca9254)

- **resolv.conf 내용 확인하기**

```
[root@19crac1 ~]# cat /etc/resolv.conf
```

![Cap 2024-04-05 10-56-31-592](https://github.com/oraclejyp/19c_rac_inst/assets/133745372/d01a22d2-9b2b-4ca5-8fdc-f7e5d7e56329)

- **temp 파일 시스템을 할당한다.**

```
[root@19crac1 ~]# vi /etc/fstab

#아래의 한 줄을 추가한다.
tmpfs                   /dev/shm                tmpfs   size=8g         0 0
```

![Cap 2024-04-05 11-26-10-640](https://github.com/oraclejyp/19c_rac_inst/assets/133745372/27d33d59-f198-4c40-b458-b89a32c3d855)

```
[root@19crac1 ~]# mount -o remount /dev/shm
[root@19crac1 ~]# df -h /dev/shm
```

remount하여 적용시킨다.


- **그룹 및 패스워드 설정**

```
[root@19crac1 ~]# usermod -g dba -G dba oracle
[root@19crac1 ~]# passwd oracle
```

- **필수 패키지 및 ASMLib설치**

오라클 설치 전에 preinstall 패키지를 설치한다.

```
[root@19crac1 ~]# yum install -y oracle-database-preinstall-19c
```

![Cap 2024-04-05 11-03-54-872](https://github.com/oraclejyp/19c_rac_inst/assets/133745372/e4e5d105-bd42-4ee8-ba34-1fd685e48030)

![Cap 2024-04-05 11-02-20-305](https://github.com/oraclejyp/19c_rac_inst/assets/133745372/e3a34bf0-10c1-4610-9638-5965436ff5b8)

https://www.oracle.com/linux/downloads/linux-asmlib-v8-downloads.html

에서 oracleasmlib-2.0.17-1.el8.x86_64.rpm를 다운로드하고 모바텀을 이용해 리눅스에 올린다.

https://yum.oracle.com/repo/OracleLinux/OL8/addons/x86_64/index.html

에서 oracleasm-support-2.1.12-1.el8.x86_64.rpm을 다운로드하고 모바텀을 이용해 리눅스에 올린다.

```
[root@19crac1 ~]# rpm -ivh oracleasmlib-2.0.17-1.el8.x86_64.rpm
[root@19crac1 ~]# rpm -ivh oracleasm-support-2.1.12-1.el8.x86_64.rpm
```

- **오라클 소프트웨어 설치를 위한 디렉토리 생성**

```
[root@19crac1 ~]# mkdir -p /u01/app/oracle
[root@19crac1 ~]# chown -R oracle:oinstall /u01
[root@19crac1 ~]# chmod -R 775 /u01
```

![Cap 2024-04-05 12-06-53-677](https://github.com/oraclejyp/19c_rac_inst/assets/133745372/a6d97525-5556-49f7-9501-cb9671e0e584)



- **공유메모리 값 설정**

![Cap 2024-04-05 11-08-58-943](https://github.com/oraclejyp/19c_rac_inst/assets/133745372/f085db69-3f8b-4ec9-ae7a-a079b27928bd)

/etc/sysctl.conf의 shmmax, shmall 값을 메모리값인 4GB로 수정하고 값을 확인한다.

```
[root@19crac1 ~]# vi /etc/sysctl.conf

[root@19crac1 ~]# /sbin/sysctl -p
```

shmmax = 단일 프로세스가 공유 메모리를 호출하기 위한 최대 값

shmall = 모든 프로세스가 사용할 수 있는 총 공유 메모리 값

-**oracle 유저의 .bash_profile 수정**

```
[root@19crac1 ~]# vi ~oracle/.bash_profile

#아래의 내용을 추가한다.

export TMP=/tmp
export TMPDIR=$TMP
export EDITOR=vi
export ORACLE_HOSTNAME=19crac1             # 호스트명에 맞게 변경
export ORACLE_UNQNAME=19cracdb
export ORACLE_BASE=/u01/app/oracle
export GRID_HOME=/u01/app/19c/grid
export DB_HOME=$ORACLE_BASE/product/19c/db_1
export ORACLE_HOME=$DB_HOME
export ORACLE_SID=19cracdb1                # 2번 노드 racdb2
export ORACLE_TERM=xterm
export BASE_PATH=/usr/sbin:$PATH
export PATH=$ORACLE_HOME/bin:$ORACLE_HOME/OPatch:$GI_HOME/bin:$BASE_PATH
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib
export CLASSPATH=$ORACLE_HOME/JRE:$ORACLE_HOME/jlib:$ORACLE_HOME/rdbms/jlib
export NLS_LANG=AMERICAN_KOREA.AL32UTF8
export PS1='[`echo $ORACLE_SID`:\W]$ '
```
